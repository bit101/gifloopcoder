/*
 RequireJS 2.1.20 Copyright (c) 2010-2015, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*
 * NeuQuant Neural-Net Quantization Algorithm
 * ------------------------------------------
 *
 * Copyright (c) 1994 Anthony Dekker
 *
 * NEUQUANT Neural-Net quantization algorithm by Anthony Dekker, 1994. See
 * "Kohonen neural networks for optimal colour quantization" in "Network:
 * Computation in Neural Systems" Vol. 5 (1994) pp 351-367. for a discussion of
 * the algorithm.
 *
 * Any party obtaining a copy of these files from the author, directly or
 * indirectly, is granted, free of charge, a full and unrestricted irrevocable,
 * world-wide, paid up, royalty-free, nonexclusive right and license to deal in
 * this software and documentation files (the "Software"), including without
 * limitation the rights to use, copy, modify, merge, publish, distribute,
 * sublicense, and/or sell copies of the Software, and to permit persons who
 * receive copies from any such party to do so, with the only requirement being
 * that this copyright notice remain intact.
 */

var requirejs,require,define;(function(ba){function G(e){return"[object Function]"===K.call(e)}function H(e){return"[object Array]"===K.call(e)}function v(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function T(e,t){if(e){var n;for(n=e.length-1;-1<n&&(!e[n]||!t(e[n],n,e));n-=1);}}function t(e,t){return fa.call(e,t)}function n(e,n){return t(e,n)&&e[n]}function A(e,n){for(var r in e)if(t(e,r)&&n(e[r],r))break}function U(e,n,r,i){return n&&A(n,function(n,s){if(r||!t(e,s))i&&"object"==typeof n&&n&&!H(n)&&!G(n)&&!(n instanceof RegExp)?(e[s]||(e[s]={}),U(e[s],n,r,i)):e[s]=n}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function ca(e){throw e}function da(e){if(!e)return e;var t=ba;return v(e.split("."),function(e){t=t[e]}),t}function B(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ga(r){function i(e,t,r){var i,s,o,u,a,f,l,c,t=t&&t.split("/"),h=L.map,p=h&&h["*"];if(e){e=e.split("/"),s=e.length-1,L.nodeIdCompat&&Q.test(e[s])&&(e[s]=e[s].replace(Q,"")),"."===e[0].charAt(0)&&t&&(s=t.slice(0,t.length-1),e=s.concat(e)),s=e;for(o=0;o<s.length;o++)(u=s[o],"."===u)?(s.splice(o,1),o-=1):".."===u&&0!==o&&(1!==o||".."!==s[2])&&".."!==s[o-1]&&0<o&&(s.splice(o-1,2),o-=2);e=e.join("/")}if(r&&h&&(t||p)){s=e.split("/"),o=s.length;e:for(;0<o;o-=1){a=s.slice(0,o).join("/");if(t)for(u=t.length;0<u;u-=1)if(r=n(h,t.slice(0,u).join("/")))if(r=n(r,a)){i=r,f=o;break e}!l&&p&&n(p,a)&&(l=n(p,a),c=o)}!i&&l&&(i=l,f=c),i&&(s.splice(0,f,i),e=s.join("/"))}return(i=n(L.pkgs,e))?i:e}function s(e){z&&v(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===x.contextName)return t.parentNode.removeChild(t),!0})}function o(e){var t=n(L.paths,e);if(t&&H(t)&&1<t.length)return t.shift(),x.require.undef(e),x.makeRequire(null,{skipMap:!0})([e]),!0}function a(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function f(e,t,r,s){var o,u,f=null,l=t?t.name:null,c=e,h=!0,p="";return e||(h=!1,e="_@r"+(q+=1)),e=a(e),f=e[0],e=e[1],f&&(f=i(f,l,s),u=n(j,f)),e&&(f?p=u&&u.normalize?u.normalize(e,function(e){return i(e,l,s)}):-1===e.indexOf("!")?i(e,l,s):e:(p=i(e,l,s),e=a(p),f=e[0],p=e[1],r=!0,o=x.nameToUrl(p))),r=f&&!u&&!r?"_unnormalized"+(W+=1):"",{prefix:f,name:p,parentMap:t,unnormalized:!!r,url:o,originalName:c,isDefine:h,id:(f?f+"!"+p:p)+r}}function l(e){var t=e.id,r=n(O,t);return r||(r=O[t]=new x.Module(e)),r}function c(e,r,i){var s=e.id,o=n(O,s);t(j,s)&&(!o||o.defineEmitComplete)?"defined"===r&&i(j[s]):(o=l(e),o.error&&"error"===r)?i(o.error):o.on(r,i)}function h(t,r){var i=t.requireModules,s=!1;r?r(t):(v(i,function(e){if(e=n(O,e))e.error=t,e.events.error&&(s=!0,e.emit("error",t))}),!s)&&e.onError(t)}function p(){R.length&&(v(R,function(e){var t=e[0];"string"==typeof t&&(x.defQueueMap[t]=!0),P.push(e)}),R=[])}function d(e){delete O[e],delete _[e]}function m(e,t,r){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,v(e.depMaps,function(i,s){var o=i.id,u=n(O,o);u&&!e.depMatched[s]&&!r[o]&&(n(t,o)?(e.defineDep(s,j[o]),e.check()):m(u,t,r))}),r[i]=!0)}function g(){var e,t,n=(e=1e3*L.waitSeconds)&&x.startTime+e<(new Date).getTime(),r=[],i=[],u=!1,a=!0;if(!E){E=!0,A(_,function(e){var f=e.map,l=f.id;if(e.enabled&&(f.isDefine||i.push(e),!e.error))if(!e.inited&&n)o(l)?u=t=!0:(r.push(l),s(l));else if(!e.inited&&e.fetched&&f.isDefine&&(u=!0,!f.prefix))return a=!1});if(n&&r.length)return e=B("timeout","Load timeout for modules: "+r,null,r),e.contextName=x.contextName,h(e);a&&v(i,function(e){m(e,{},{})}),(!n||t)&&u&&(z||ea)&&!k&&(k=setTimeout(function(){k=0,g()},50)),E=!1}}function y(e){t(j,e[0])||l(f(e[0],null,!0)).init(e[1],e[2])}function b(e){var e=e.currentTarget||e.srcElement,t=x.onScriptLoad;return e.detachEvent&&!Y?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=x.onScriptError,(!e.detachEvent||Y)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function w(){var e;for(p();P.length;){e=P.shift();if(null===e[0])return h(B("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));y(e)}x.defQueueMap={}}var E,S,x,C,k,L={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},O={},_={},D={},P=[],j={},F={},I={},q=1,W=1;return C={require:function(e){return e.require?e.require:e.require=x.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?j[e.map.id]=e.exports:e.exports=j[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return n(L.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},S=function(e){this.events=n(D,e.id)||{},this.map=e,this.shim=n(L.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},S.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,x.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();x.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;F[e]||(F[e]=!0,x.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var n,r,i=this.map.id;r=this.depExports;var s=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(G(o)){if(this.events.error&&this.map.isDefine||e.onError!==ca)try{s=x.execCb(i,o,r,s)}catch(u){n=u}else s=x.execCb(i,o,r,s);this.map.isDefine&&void 0===s&&((r=this.module)?s=r.exports:this.usingExports&&(s=this.exports));if(n)return n.requireMap=this.map,n.requireModules=this.map.isDefine?[this.map.id]:null,n.requireType=this.map.isDefine?"define":"require",h(this.error=n)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(j[i]=s,e.onResourceLoad)&&e.onResourceLoad(x,this.map,this.depMaps),d(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else t(x.defQueueMap,i)||this.fetch()}},callPlugin:function(){var r=this.map,s=r.id,o=f(r.prefix);this.depMaps.push(o),c(o,"defined",u(this,function(o){var a,p;p=n(I,this.map.id);var v=this.map.name,m=this.map.parentMap?this.map.parentMap.name:null,g=x.makeRequire(r.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(o.normalize&&(v=o.normalize(v,function(e){return i(e,m,!0)})||""),o=f(r.prefix+"!"+v,this.map.parentMap),c(o,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),p=n(O,o.id))this.depMaps.push(o),this.events.error&&p.on("error",u(this,function(e){this.emit("error",e)})),p.enable()}else p?(this.map.url=x.nameToUrl(p),this.load()):(a=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),a.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[s],A(O,function(e){0===e.map.id.indexOf(s+"_unnormalized")&&d(e.map.id)}),h(e)}),a.fromText=u(this,function(n,i){var o=r.name,u=f(o),c=M;i&&(n=i),c&&(M=!1),l(u),t(L.config,s)&&(L.config[o]=L.config[s]);try{e.exec(n)}catch(p){return h(B("fromtexteval","fromText eval for "+s+" failed: "+p,p,[s]))}c&&(M=!0),this.depMaps.push(u),x.completeLoad(o),g([o],a)}),o.load(r.name,g,a,L))})),x.enable(o,this),this.pluginMaps[o.id]=o},enable:function(){_[this.map.id]=this,this.enabling=this.enabled=!0,v(this.depMaps,u(this,function(e,r){var i,s;if("string"==typeof e){e=f(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[r]=e;if(i=n(C,e.id)){this.depExports[r]=i(this);return}this.depCount+=1,c(e,"defined",u(this,function(e){this.undefed||(this.defineDep(r,e),this.check())})),this.errback?c(e,"error",u(this,this.errback)):this.events.error&&c(e,"error",u(this,function(e){this.emit("error",e)}))}i=e.id,s=O[i],!t(C,i)&&s&&!s.enabled&&x.enable(e,this)})),A(this.pluginMaps,u(this,function(e){var t=n(O,e.id);t&&!t.enabled&&x.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){v(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},x={config:L,contextName:r,registry:O,defined:j,urlFetched:F,defQueue:P,defQueueMap:{},Module:S,makeModuleMap:f,nextTick:e.nextTick,onError:h,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=L.shim,n={paths:!0,bundles:!0,config:!0,map:!0};A(e,function(e,t){n[t]?(L[t]||(L[t]={}),U(L[t],e,!0,!0)):L[t]=e}),e.bundles&&A(e.bundles,function(e,t){v(e,function(e){e!==t&&(I[e]=t)})}),e.shim&&(A(e.shim,function(e,n){H(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=x.makeShimExports(e)),t[n]=e}),L.shim=t),e.packages&&v(e.packages,function(e){var t,e="string"==typeof e?{name:e}:e;t=e.name,e.location&&(L.paths[t]=e.location),L.pkgs[t]=e.name+"/"+(e.main||"main").replace(ha,"").replace(Q,"")}),A(O,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=f(t,null,!0))}),(e.deps||e.callback)&&x.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(ba,arguments)),t||e.exports&&da(e.exports)}},makeRequire:function(o,u){function a(n,i,s){var c,p;return u.enableBuildCallback&&i&&G(i)&&(i.__requireJsBuild=!0),"string"==typeof n?G(i)?h(B("requireargs","Invalid require call"),s):o&&t(C,n)?C[n](O[o.id]):e.get?e.get(x,n,o,a):(c=f(n,o,!1,!0),c=c.id,t(j,c)?j[c]:h(B("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+r+(o?"":". Use require([])")))):(w(),x.nextTick(function(){w(),p=l(f(null,o)),p.skipMap=u.skipMap,p.init(n,i,s,{enabled:!0}),g()}),a)}return u=u||{},U(a,{isBrowser:z,toUrl:function(e){var t,n=e.lastIndexOf("."),r=e.split("/")[0];return-1!==n&&("."!==r&&".."!==r||1<n)&&(t=e.substring(n,e.length),e=e.substring(0,n)),x.nameToUrl(i(e,o&&o.id,!0),t,!0)},defined:function(e){return t(j,f(e,o,!1,!0).id)},specified:function(e){return e=f(e,o,!1,!0).id,t(j,e)||t(O,e)}}),o||(a.undef=function(e){p();var t=f(e,o,!0),r=n(O,e);r.undefed=!0,s(e),delete j[e],delete F[t.url],delete D[e],T(P,function(t,n){t[0]===e&&P.splice(n,1)}),delete x.defQueueMap[e],r&&(r.events.defined&&(D[e]=r.events),d(e))}),a},enable:function(e){n(O,e.id)&&l(e).enable()},completeLoad:function(e){var r,i,s=n(L.shim,e)||{},u=s.exports;for(p();P.length;){i=P.shift();if(null===i[0]){i[0]=e;if(r)break;r=!0}else i[0]===e&&(r=!0);y(i)}x.defQueueMap={},i=n(O,e);if(!r&&!t(j,e)&&i&&!i.inited){if(L.enforceDefine&&(!u||!da(u)))return o(e)?void 0:h(B("nodefine","No define call for "+e,null,[e]));y([e,s.deps||[],s.exportsFn])}g()},nameToUrl:function(t,r,i){var s,o,u;(s=n(L.pkgs,t))&&(t=s);if(s=n(I,t))return x.nameToUrl(s,r,i);if(e.jsExtRegExp.test(t))s=t+(r||"");else{s=L.paths,t=t.split("/");for(o=t.length;0<o;o-=1)if(u=t.slice(0,o).join("/"),u=n(s,u)){H(u)&&(u=u[0]),t.splice(0,o,u);break}s=t.join("/"),s+=r||(/^data\:|\?/.test(s)||i?"":".js"),s=("/"===s.charAt(0)||s.match(/^[\w\+\.\-]+:/)?"":L.baseUrl)+s}return L.urlArgs?s+((-1===s.indexOf("?")?"?":"&")+L.urlArgs):s},load:function(t,n){e.load(x,t,n)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||ia.test((e.currentTarget||e.srcElement).readyState))N=null,e=b(e),x.completeLoad(e.id)},onScriptError:function(e){var t=b(e);if(!o(t.id))return h(B("scripterror","Script error for: "+t.id,e,[t.id]))}},x.require=x.makeRequire(),x}var e,x,y,D,I,E,N,J,r,O,ja=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ka=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,Q=/\.js$/,ha=/^\.\//;x=Object.prototype;var K=x.toString,fa=x.hasOwnProperty,z="undefined"!=typeof window&&"undefined"!=typeof navigator&&!!window.document,ea=!z&&"undefined"!=typeof importScripts,ia=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,Y="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),F={},s={},R=[],M=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(G(requirejs))return;s=requirejs,requirejs=void 0}"undefined"!=typeof require&&!G(require)&&(s=require,require=void 0),e=requirejs=function(t,r,i,s){var o,u="_";return!H(t)&&"string"!=typeof t&&(o=t,H(r)?(t=r,r=i,i=s):t=[]),o&&o.context&&(u=o.context),(s=n(F,u))||(s=F[u]=e.s.newContext(u)),o&&s.configure(o),s.require(t,r,i)},e.config=function(t){return e(t)},e.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=e),e.version="2.1.20",e.jsExtRegExp=/^\/|:|\?|\.js$/,e.isBrowser=z,x=e.s={contexts:F,newContext:ga},e({}),v(["toUrl","undef","defined","specified"],function(t){e[t]=function(){var e=F._;return e.require[t].apply(e,arguments)}}),z&&(y=x.head=document.getElementsByTagName("head")[0],D=document.getElementsByTagName("base")[0])&&(y=x.head=D.parentNode),e.onError=ca,e.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},e.load=function(t,n,r){var i=t&&t.config||{},s;if(z)return s=e.createNode(i,n,r),i.onNodeCreated&&i.onNodeCreated(s,i,n,r),s.setAttribute("data-requirecontext",t.contextName),s.setAttribute("data-requiremodule",n),s.attachEvent&&!(s.attachEvent.toString&&0>s.attachEvent.toString().indexOf("[native code"))&&!Y?(M=!0,s.attachEvent("onreadystatechange",t.onScriptLoad)):(s.addEventListener("load",t.onScriptLoad,!1),s.addEventListener("error",t.onScriptError,!1)),s.src=r,J=s,D?y.insertBefore(s,D):y.appendChild(s),J=null,s;if(ea)try{importScripts(r),t.completeLoad(n)}catch(o){t.onError(B("importscripts","importScripts failed for "+n+" at "+r,o,[n]))}},z&&!s.skipDataMain&&T(document.getElementsByTagName("script"),function(t){y||(y=t.parentNode);if(I=t.getAttribute("data-main"))return r=I,s.baseUrl||(E=r.split("/"),r=E.pop(),O=E.length?E.join("/")+"/":"./",s.baseUrl=O),r=r.replace(Q,""),e.jsExtRegExp.test(r)&&(r=I),s.deps=s.deps?s.deps.concat(r):[r],!0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),H(t)||(n=t,t=null),!t&&G(n)&&(t=[],n.length&&(n.toString().replace(ja,"").replace(ka,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),M&&((r=J)||(N&&"interactive"===N.readyState||T(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return N=e}),r=N),r&&(e||(e=r.getAttribute("data-requiremodule")),i=F[r.getAttribute("data-requirecontext")])),i?(i.defQueue.push([e,t,n]),i.defQueueMap[e]=!0):R.push([e,t,n])},define.amd={jQuery:!0},e.exec=function(b){return eval(b)},e(s)}})(this),define("requireLib",function(){}),define("app/valueparser",[],function(){return{getNumber:function(e,t,n){if(typeof e=="number")return e;if(typeof e=="function")return e(t);if(e&&e.length===2){var r=e[0],i=e[1];return r+(i-r)*t}return e&&e.length?e[Math.round(t*(e.length-1))]:n},getString:function(e,t,n){return e===undefined?n:typeof e=="string"?e:typeof e=="function"?e(t):e&&e.length?e[Math.round(t*(e.length-1))]:e},getBool:function(e,t,n){return e===undefined?n:typeof e=="function"?e(t):e&&e.length?e[Math.round(t*(e.length-1))]:e},getArray:function(e,t,n){if(typeof e=="string")return n;if(typeof e=="function")return e(t);if(e&&e.length==2&&e[0].length&&e[1].length){var r=e[0],i=e[1],s=Math.min(r.length,i.length),o=[];for(var u=0;u<s;u++){var a=r[u],f=i[u];o.push(a+(f-a)*t)}return o}return e&&e.length>1?e:n},getObject:function(e,t,n){return e===undefined?n:typeof e=="function"?e(t):e&&e.length?e[Math.round(t*(e.length-1))]:e}}}),define("app/colorparser",[],function(){function t(t,f,l){if(t===undefined)return l;if(typeof t=="string"){if(t.charAt(0)==="#"&&t.length>7){var c=u(t);return o(c)}return t}if(typeof t=="function")return t(f);if(t&&t.length===2){if(n(t))return r(t,f);if(i(t))return s(t,f);var h=u(t[0]),p=u(t[1]);return a([h,p],f)}if(t&&t.length)return t[Math.round(f*(t.length-1))];if(t.type==="linearGradient"){var d=e.createLinearGradient(t.x0,t.y0,t.x1,t.y1);for(var v=0;v<t.colorStops.length;v++){var m=t.colorStops[v];d.addColorStop(m.position,m.color)}return d}if(t.type==="radialGradient"){var d=e.createRadialGradient(t.x0,t.y0,t.r0,t.x1,t.y1,t.r1);for(var v=0;v<t.colorStops.length;v++){var m=t.colorStops[v];d.addColorStop(m.position,m.color)}return d}return l}function n(e){return e[0].type==="linearGradient"&&e[1].type==="linearGradient"}function r(t,n){var r=t[0],i=t[1],s=r.x0+(i.x0-r.x0)*n,o=r.y0+(i.y0-r.y0)*n,f=r.x1+(i.x1-r.x1)*n,l=r.y1+(i.y1-r.y1)*n,c=e.createLinearGradient(s,o,f,l);for(var h=0;h<r.colorStops.length;h++){var p=r.colorStops[h],d=i.colorStops[h],v=p.position+(d.position-p.position)*n,m=u(p.color),g=u(d.color),y=a([m,g],n);c.addColorStop(v,y)}return c}function i(e){return e[0].type==="radialGradient"&&e[1].type==="radialGradient"}function s(t,n){var r=t[0],i=t[1],s=r.x0+(i.x0-r.x0)*n,o=r.y0+(i.y0-r.y0)*n,f=r.r0+(i.r0-r.r0)*n,l=r.x1+(i.x1-r.x1)*n,c=r.y1+(i.y1-r.y1)*n,h=r.r1+(i.r1-r.r1)*n,p=e.createRadialGradient(s,o,f,l,c,h);for(var d=0;d<r.colorStops.length;d++){var v=r.colorStops[d],m=i.colorStops[d],g=v.position+(m.position-v.position)*n,y=u(v.color),b=u(m.color),w=a([y,b],n);p.addColorStop(g,w)}return p}function o(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a/255+")"}function u(e){if(e.charAt(0)==="#"){if(e.length===7)return{a:255,r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)};if(e.length===9)return{a:parseInt(e.substring(1,3),16),r:parseInt(e.substring(3,5),16),g:parseInt(e.substring(5,7),16),b:parseInt(e.substring(7,9),16)};var t=e.charAt(1),n=e.charAt(2),r=e.charAt(3);return{a:255,r:parseInt(t+t,16),g:parseInt(n+n,16),b:parseInt(r+r,16)}}if(e.substring(0,4)==="rgb("){var i=e.indexOf("(")+1,s=e.indexOf(")"),o=e.substring(i,s).split(",");return{a:255,r:parseInt(o[0],10),g:parseInt(o[1],10),b:parseInt(o[2],10)}}if(e.substring(0,4)==="rgba"){var i=e.indexOf("(")+1,s=e.indexOf(")"),o=e.substring(i,s).split(",");return{a:parseFloat(o[3])*255,r:parseInt(o[0],10),g:parseInt(o[1],10),b:parseInt(o[2],10)}}return e=e.toLowerCase(),f[e]!=null?u(f[e]):0}function a(e,t){var n=e[0],r=e[1],i=n.a+(r.a-n.a)*t,s=Math.round(n.r+(r.r-n.r)*t),o=Math.round(n.g+(r.g-n.g)*t),u=Math.round(n.b+(r.b-n.b)*t);return"rgba("+s+","+o+","+u+","+i/255+")"}var e=document.createElement("canvas").getContext("2d"),f={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return{getColor:t}}),define("app/shapes/shape",["app/valueparser","app/colorparser"],function(e,t){return{styles:null,interpolation:null,create:function(e,t){var n=Object.create(this);return n.init(e,t||{}),n},init:function(e,t){this.props=t;for(var n in t){var r=t[n];typeof r=="function"&&(t[n]=r.bind(t))}this.draw=e.draw,this.list=[]},add:function(e){return this.list.push(e),e},clear:function(){this.list.length=0},render:function(e,t,n){if(!n)var t=this.interpolate(t);this.startDraw(e,t),this.draw(e,t);for(var r in this.list)this.list[r].render(e,t,!0);this.endDraw(e,t)},interpolate:function(e){e*=this.props.speedMult||1,e+=this.props.phase||0;switch(this.interpolation.mode){case"bounce":if(this.interpolation.easing){var t=e*Math.PI*2;return.5-Math.cos(t)*.5}return e%=1,e<.5?e*2:e=(1-e)*2;case"single":e>1&&(e%=1);if(this.interpolation.easing){var t=e*Math.PI;return.5-Math.cos(t)*.5}return e}},startDraw:function(e,t){e.save(),e.lineWidth=this.getNumber("lineWidth",t,this.styles.lineWidth),e.strokeStyle=this.getColor("strokeStyle",t,this.styles.strokeStyle),e.fillStyle=this.getColor("fillStyle",t,this.styles.fillStyle),e.lineCap=this.getString("lineCap",t,this.styles.lineCap),e.lineJoin=this.getString("lineJoin",t,this.styles.lineJoin),e.miterLimit=this.getString("miterLimit",t,this.styles.miterLimit),e.globalAlpha=this.getNumber("globalAlpha",t,this.styles.globalAlpha),e.translate(this.getNumber("translationX",t,this.styles.translationX),this.getNumber("translationY",t,this.styles.translationY)),e.globalCompositeOperation=this.getString("blendMode",t,this.styles.blendMode);var n=this.getNumber("shake",t,this.styles.shake);e.translate(Math.random()*n-n/2,Math.random()*n-n/2);var r=this.getArray("lineDash",t,this.styles.lineDash);r&&e.setLineDash(r),e.beginPath()},drawFillAndStroke:function(e,t,n,r){var i=this.getBool("fill",t,n),s=this.getBool("stroke",t,r);e.save(),i&&(this.setShadowParams(e,t),e.fill()),e.restore(),s&&(i||this.setShadowParams(e,t),e.stroke())},setShadowParams:function(e,t){e.shadowColor=this.getColor("shadowColor",t,this.styles.shadowColor),e.shadowOffsetX=this.getNumber("shadowOffsetX",t,this.styles.shadowOffsetX),e.shadowOffsetY=this.getNumber("shadowOffsetY",t,this.styles.shadowOffsetY),e.shadowBlur=this.getNumber("shadowBlur",t,this.styles.shadowBlur)},endDraw:function(e){e.restore()},getNumber:function(t,n,r){return e.getNumber(this.props[t],n,r)},getColor:function(e,n,r){return t.getColor(this.props[e],n,r)},getString:function(t,n,r){return e.getString(this.props[t],n,r)},getBool:function(t,n,r){return e.getBool(this.props[t],n,r)},getArray:function(t,n,r){return e.getArray(this.props[t],n,r)},getObject:function(t,n,r){return e.getObject(this.props[t],n,r)},getPosition:function(t,n,r){return e.getPosition(this.props[t],n,r)}}}),define("app/shapes/arrow",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("w",t,100),s=this.getNumber("h",t,100),o=this.getNumber("pointPercent",t,.5),u=this.getNumber("shaftPercent",t,.5);e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),e.moveTo(-i/2,-s*u*.5),e.lineTo(i/2-i*o,-s*u*.5),e.lineTo(i/2-i*o,-s*.5),e.lineTo(i/2,0),e.lineTo(i/2-i*o,s*.5),e.lineTo(i/2-i*o,s*u*.5),e.lineTo(-i/2,s*u*.5),e.lineTo(-i/2,-s*u*.5),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/arcSegment",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("radius",t,50),s=this.getNumber("startAngle",t,0),o=this.getNumber("endAngle",t,360);if(s>o){var u=s;s=o,o=u}var a=this.getNumber("arc",t,20),f=s-1,l=s+t*(o-s+a);l>s+a&&(f=l-a),l>o&&(l=o+1),e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),e.arc(0,0,i,f*Math.PI/180,l*Math.PI/180),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/beziercurve",[],function(){return{draw:function(e,t){var n=this.getNumber("x0",t,50),r=this.getNumber("y0",t,10),i=this.getNumber("x1",t,200),s=this.getNumber("y1",t,100),o=this.getNumber("x2",t,0),u=this.getNumber("y2",t,100),a=this.getNumber("x3",t,150),f=this.getNumber("y3",t,10);e.moveTo(n,r),e.bezierCurveTo(i,s,o,u,a,f),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/beziersegment",[],function(){function e(e,t,n,r,i){return(1-e)*(1-e)*(1-e)*t+3*(1-e)*(1-e)*e*n+3*(1-e)*e*e*r+e*e*e*i}return{draw:function(t,n){var r=this.getNumber("x0",n,50),i=this.getNumber("y0",n,10),s=this.getNumber("x1",n,200),o=this.getNumber("y1",n,100),u=this.getNumber("x2",n,0),a=this.getNumber("y2",n,100),f=this.getNumber("x3",n,150),l=this.getNumber("y3",n,10),c=this.getNumber("percent",n,.1),h=n*(1+c),p=h-c,d=.01,v,m;h=Math.min(h,1.001),p=Math.max(p,-0.001);for(var g=p;g<h;g+=d)v=e(g,r,s,u,f),m=e(g,i,o,a,l),g===p?t.moveTo(v,m):t.lineTo(v,m);v=e(h,r,s,u,f),m=e(h,i,o,a,l),t.lineTo(v,m),this.drawFillAndStroke(t,n,!1,!0)}}}),define("app/shapes/circle",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("radius",t,50),s=this.getNumber("startAngle",t,0),o=this.getNumber("endAngle",t,360),u=this.getBool("drawFromCenter",t,!1);e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),u&&e.moveTo(0,0),e.arc(0,0,i,s*Math.PI/180,o*Math.PI/180),u&&e.closePath(),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/container",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,0),r=this.getNumber("y",t,0);e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180)}}}),define("app/shapes/cube",[],function(){function e(e,t){for(var n=0;n<e.length;n++){var r=e[n];r.x*=t,r.y*=t,r.z*=t}}function t(e,t){var n=Math.cos(t),r=Math.sin(t);for(var i=0;i<e.length;i++){var s=e[i],o=s.y*n-s.z*r,u=s.z*n+s.y*r;s.y=o,s.z=u}}function n(e,t){var n=Math.cos(t),r=Math.sin(t);for(var i=0;i<e.length;i++){var s=e[i],o=s.x*n-s.z*r,u=s.z*n+s.x*r;s.x=o,s.z=u}}function r(e,t){var n=Math.cos(t),r=Math.sin(t);for(var i=0;i<e.length;i++){var s=e[i],o=s.x*n-s.y*r,u=s.y*n+s.x*r;s.x=o,s.y=u}}function i(e,t){var n=300;for(var r=0;r<e.length;r++){var i=e[r],s=n/(n+i.z+t);i.sx=i.x*s,i.sy=i.y*s}}function s(){return[{x:-1,y:-1,z:-1},{x:1,y:-1,z:-1},{x:1,y:1,z:-1},{x:-1,y:1,z:-1},{x:-1,y:-1,z:1},{x:1,y:-1,z:1},{x:1,y:1,z:1},{x:-1,y:1,z:1}]}return{draw:function(o,u){var a=this.getNumber("x",u,100),f=this.getNumber("y",u,100),l=this.getNumber("z",u,0),c=this.getNumber("size",u,100),h=this.getNumber("rotationX",u,0)*Math.PI/180,p=this.getNumber("rotationY",u,0)*Math.PI/180,d=this.getNumber("rotationZ",u,0)*Math.PI/180,v=s();e(v,c/2),t(v,h),n(v,p),r(v,d),i(v,l),o.lineJoin=this.getString("lineJoin",u,"round"),o.lineWidth=this.getNumber("lineWidth",u,1),o.translate(a,f),o.moveTo(v[0].sx,v[0].sy),o.lineTo(v[1].sx,v[1].sy),o.lineTo(v[2].sx,v[2].sy),o.lineTo(v[3].sx,v[3].sy),o.lineTo(v[0].sx,v[0].sy),o.moveTo(v[4].sx,v[4].sy),o.lineTo(v[5].sx,v[5].sy),o.lineTo(v[6].sx,v[6].sy),o.lineTo(v[7].sx,v[7].sy),o.lineTo(v[4].sx,v[4].sy),o.moveTo(v[0].sx,v[0].sy),o.lineTo(v[4].sx,v[4].sy),o.moveTo(v[1].sx,v[1].sy),o.lineTo(v[5].sx,v[5].sy),o.moveTo(v[2].sx,v[2].sy),o.lineTo(v[6].sx,v[6].sy),o.moveTo(v[3].sx,v[3].sy),o.lineTo(v[7].sx,v[7].sy),this.setShadowParams(o,u),o.stroke()}}}),define("app/shapes/curve",[],function(){return{draw:function(e,t){var n=this.getNumber("x0",t,20),r=this.getNumber("y0",t,10),i=this.getNumber("x1",t,100),s=this.getNumber("y1",t,200),o=this.getNumber("x2",t,180),u=this.getNumber("y2",t,10);e.moveTo(n,r),e.quadraticCurveTo(i,s,o,u),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/curvesegment",[],function(){function e(e,t,n,r){return(1-e)*(1-e)*t+2*(1-e)*e*n+e*e*r}return{draw:function(t,n){var r=this.getNumber("x0",n,20),i=this.getNumber("y0",n,20),s=this.getNumber("x1",n,100),o=this.getNumber("y1",n,200),u=this.getNumber("x2",n,180),a=this.getNumber("y2",n,20),f=this.getNumber("percent",n,.1),l=n*(1+f),c=l-f,h=.01,p,d;l=Math.min(l,1),c=Math.max(c,0);for(var v=c;v<l;v+=h)p=e(v,r,s,u),d=e(v,i,o,a),v===c?t.moveTo(p,d):t.lineTo(p,d);p=e(l,r,s,u),d=e(l,i,o,a),t.lineTo(p,d),this.drawFillAndStroke(t,n,!1,!0)}}}),define("app/shapes/gear",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("radius",t,50),s=this.getNumber("toothHeight",t,10),o=this.getNumber("hub",t,10),u=this.getNumber("rotation",t,0)*Math.PI/180,a=this.getNumber("teeth",t,10),f=this.getNumber("toothAngle",t,.3),l=.5-f/2,c=.5-l,h=i-s;e.translate(n,r),e.rotate(u),e.save(),e.moveTo(i,0);var p=Math.PI*2/a;for(var d=0;d<a;d++)e.rotate(p*l),e.lineTo(i,0),e.rotate(p*c),e.lineTo(h,0),e.rotate(p*l),e.lineTo(h,0),e.rotate(p*c),e.lineTo(i,0);e.lineTo(i,0),e.restore(),e.moveTo(o,0),e.arc(0,0,o,0,Math.PI*2,!0),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/grid",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,0),r=this.getNumber("y",t,0),i=this.getNumber("w",t,100),s=this.getNumber("h",t,100),o=this.getNumber("gridSize",t,20);for(var u=r;u<=r+s;u+=o)e.moveTo(n,u),e.lineTo(n+i,u);for(u=n;u<=n+i;u+=o)e.moveTo(u,r),e.lineTo(u,r+s);this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/heart",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("w",t,50),s=this.getNumber("h",t,50),o=0,u=-0.25,a=.2,f=-0.8,l=1.1,c=-0.2,h=0,p=.5;e.save(),e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),e.save(),e.scale(i,s),e.moveTo(o,u),e.bezierCurveTo(a,f,l,c,h,p),e.bezierCurveTo(-l,c,-a,f,-o,u),e.restore(),this.drawFillAndStroke(e,t,!0,!1),e.restore()}}}),define("app/shapes/line",[],function(){return{draw:function(e,t){var n=this.getNumber("x0",t,0),r=this.getNumber("y0",t,0),i=this.getNumber("x1",t,100),s=this.getNumber("y1",t,100);e.moveTo(n,r),e.lineTo(i,s),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/oval",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("rx",t,50),s=this.getNumber("ry",t,50),o=this.getNumber("startAngle",t,0),u=this.getNumber("endAngle",t,360),a=this.getBool("drawFromCenter",t,!1);e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),e.save(),e.scale(i/100,s/100),a&&e.moveTo(0,0),e.arc(0,0,100,o*Math.PI/180,u*Math.PI/180),a&&e.closePath(),e.restore(),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/path",[],function(){return{draw:function(e,t){var n=this.getArray("path",t,[]),r=this.getNumber("startPercent",t,0),i=this.getNumber("endPercent",t,1),s=Math.floor(n.length/2*r),o=Math.floor(n.length/2*i),u=s*2,a=o*2;if(u>a){var f=u;u=a,a=f}e.moveTo(n[u],n[u+1]);for(var l=u+2;l<a-1;l+=2)e.lineTo(n[l],n[l+1]);this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/poly",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("radius",t,50),s=this.getNumber("rotation",t,0)*Math.PI/180,o=this.getNumber("sides",t,5);e.translate(n,r),e.rotate(s),e.moveTo(i,0);for(var u=1;u<o;u++){var a=Math.PI*2/o*u;e.lineTo(Math.cos(a)*i,Math.sin(a)*i)}e.lineTo(i,0),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/ray",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("angle",t,0)*Math.PI/180,s=this.getNumber("length",t,100);e.translate(n,r),e.rotate(i),e.moveTo(0,0),e.lineTo(s,0),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/raysegment",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("angle",t,0)*Math.PI/180,s=this.getNumber("length",t,100),o=this.getNumber("segmentLength",t,50),u=-0.01,a=(s+o)*t;a>o&&(u=a-o),a>s&&(a=s+.01),e.translate(n,r),e.rotate(i),e.moveTo(u,0),e.lineTo(a,0),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/rect",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("w",t,100),s=this.getNumber("h",t,100);e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180),this.getBool("drawFromCenter",t,!0)?e.rect(-i*.5,-s*.5,i,s):e.rect(0,0,i,s),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/segment",[],function(){return{draw:function(e,t){var n=this.getNumber("x0",t,0),r=this.getNumber("y0",t,0),i=this.getNumber("x1",t,100),s=this.getNumber("y1",t,100),o=this.getNumber("segmentLength",t,50),u=i-n,a=s-r,f=Math.atan2(a,u),l=Math.sqrt(u*u+a*a),c=-0.01,h=(l+o)*t;h>o&&(c=h-o),h>l&&(h=l+.01),e.translate(n,r),e.rotate(f),e.moveTo(c,0),e.lineTo(h,0),this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/spiral",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,"100"),r=this.getNumber("y",t,"100"),i=this.getNumber("innerRadius",t,10),s=this.getNumber("outerRadius",t,90),o=this.getNumber("turns",t,6),u=this.getNumber("res",t,1)*Math.PI/180,a=Math.PI*2*o;e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180);if(a>0)for(var f=0;f<a;f+=u){var l=i+(s-i)*f/a;e.lineTo(Math.cos(f)*l,Math.sin(f)*l)}else for(var f=0;f>a;f-=u){var l=i+(s-i)*f/a;e.lineTo(Math.cos(f)*l,Math.sin(f)*l)}this.drawFillAndStroke(e,t,!1,!0)}}}),define("app/shapes/star",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getNumber("innerRadius",t,25),s=this.getNumber("outerRadius",t,50),o=this.getNumber("rotation",t,0)*Math.PI/180,u=this.getNumber("points",t,5);e.translate(n,r),e.rotate(o),e.moveTo(s,0);for(var a=1;a<u*2;a++){var f=Math.PI*2/u/2*a,l=a%2?i:s;e.lineTo(Math.cos(f)*l,Math.sin(f)*l)}e.lineTo(s,0),this.drawFillAndStroke(e,t,!0,!1)}}}),define("app/shapes/text",[],function(){return{draw:function(e,t){var n=this.getNumber("x",t,100),r=this.getNumber("y",t,100),i=this.getString("text",t,"hello"),s=this.getNumber("fontSize",t,20),o=this.getString("fontWeight",t,"normal");fontFamily=this.getString("fontFamily",t,"sans-serif"),fontStyle=this.getString("fontStyle",t,"normal"),e.font=o+" "+fontStyle+" "+s+"px "+fontFamily;var u=e.measureText(i).width;e.translate(n,r),e.rotate(this.getNumber("rotation",t,0)*Math.PI/180);var a=!1;e.save(),this.getBool("fill",t,!0)&&(this.setShadowParams(e,t),a=!0,e.fillText(i,-u/2,s*.4)),e.restore(),this.getBool("stroke",t,!1)&&(a||this.setShadowParams(e,t),e.strokeText(i,-u/2,s*.4))}}}),define("app/renderlist",["app/shapes/shape","app/shapes/arrow","app/shapes/arcSegment","app/shapes/beziercurve","app/shapes/beziersegment","app/shapes/circle","app/shapes/container","app/shapes/cube","app/shapes/curve","app/shapes/curvesegment","app/shapes/gear","app/shapes/grid","app/shapes/heart","app/shapes/line","app/shapes/oval","app/shapes/path","app/shapes/poly","app/shapes/ray","app/shapes/raysegment","app/shapes/rect","app/shapes/segment","app/shapes/spiral","app/shapes/star","app/shapes/text"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){function O(t,n,r,i){T=document.createElement("canvas"),C=T.width=t,k=T.height=n,N=T.getContext("2d"),A=r,e.styles=A,e.interpolation=i}function M(e,t){C=T.width=e,k=T.height=t}function _(e){return e.props.parent?e.props.parent.add(e):L.push(e),rt(0),e}function D(){L.length=0}function P(n){return _(e.create(t,n))}function H(t){return _(e.create(n,t))}function B(t){return _(e.create(r,t))}function j(t){return _(e.create(i,t))}function F(t){return _(e.create(s,t))}function I(t){return _(e.create(o,t))}function q(t){return _(e.create(u,t))}function R(t){return _(e.create(a,t))}function U(t){return _(e.create(f,t))}function z(t){return _(e.create(l,t))}function W(t){return _(e.create(c,t))}function X(t){return _(e.create(h,t))}function V(t){return _(e.create(p,t))}function $(t){return _(e.create(d,t))}function J(t){return _(e.create(v,t))}function K(t){return _(e.create(m,t))}function Q(t){return _(e.create(g,t))}function G(t){return _(e.create(y,t))}function Y(t){return _(e.create(b,t))}function Z(t){return _(e.create(w,t))}function et(t){return _(e.create(E,t))}function tt(t){return _(e.create(S,t))}function nt(t){return _(e.create(x,t))}function rt(e){A.backgroundColor==="transparent"?N.clearRect(0,0,C,k):(N.fillStyle=A.backgroundColor,N.fillRect(0,0,C,k));for(var t=0;t<L.length;t++)L[t].render(N,e)}function it(){return T}function st(){return N}var T=null,N=null,C=0,k=0,L=[],A=null;return{init:O,size:M,getCanvas:it,getContext:st,add:_,clear:D,addArrow:P,addArcSegment:H,addBezierCurve:B,addBezierSegment:j,addCircle:F,addContainer:I,addCube:q,addCurve:R,addCurveSegment:U,addGear:z,addGrid:W,addHeart:X,addLine:V,addOval:$,addPath:J,addPoly:K,addRay:Q,addRaySegment:G,addRect:Y,addSegment:Z,addSpiral:et,addStar:tt,addText:nt,render:rt}}),define("app/scheduler",[],function(){function a(e,t){s=e,o=t}function f(){r?(s&&s(e),c(),setTimeout(l,1e3/n)):o&&o()}function l(){requestAnimationFrame(f)}function c(){var r=t*n,s=1/r;e+=s,Math.round(e*1e4)/1e4>=1&&(i?e-=1:(e=0,p()))}function h(){r||(e=0,i=!0,r=!0,f())}function p(){r=!1,i=!1,e=0}function d(){r||(e=0,i=!1,r=!0,f())}function v(){return r}function m(e){t=e}function g(){return t}function y(e){n=e}function b(){return n}var e=0,t=2,n=30,r=!1,i=!1,s=null,o=null,u=null;return{init:a,loop:h,playOnce:d,stop:p,isRunning:v,setDuration:m,getDuration:g,setFPS:y,getFPS:b}}),define("app/styles",[],function(){return{backgroundColor:"#ffffff",lineWidth:5,strokeStyle:"#000000",fillStyle:"#000000",lineCap:"round",lineJoin:"miter",lineDash:[],miterLimit:10,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,globalAlpha:1,translationX:0,translationY:0,shake:0,blendMode:"source-over"}}),define("app/interpolation",[],function(){return{mode:"bounce",easing:!0}}),define("app/spritesheet",[],function(){function u(e,t){s=e,o=t}function a(e){t.drawImage(e,r,i),r+=s,r+s>n&&(r=0,i+=o)}function f(){return e.toDataURL()}function l(u,a){var f=u*a,l=Math.ceil(Math.sqrt(f));n=l*Math.max(s,o);if(n>2048&&!confirm("Warning: Sprite sheets create a large bitmap with each frame of your animation laid out in a grid. Your sprite sheet will be "+n+"x"+n+", which is pretty dang big. That OK with you?"))return;e.width=e.height=n,t.clearRect(0,0,n,n),r=0,i=0}function c(){return n}var e=document.createElement("canvas"),t=e.getContext("2d"),n=0,r=0,i=0,s=0,o=0;return{setSize:u,addFrame:a,getImage:f,init:l,getSpriteSheetSize:c}}),function(){var e={_topZ:1,_panel:null,_titleBar:null,_content:null,_startX:0,_startY:0,_hidden:!1,_collapsed:!1,_controls:null,_keyCode:-1,_draggable:!0,_collapsible:!0,_globalChangeHandler:null,create:function(e,t,n){var r=Object.create(this);return r._init(e,t,n),r},_init:function(e,t,n){this._bindHandlers(),this._createPanel(e,t),this._createTitleBar(n||"QuickSettings"),this._createContent(),document.body.appendChild(this._panel)},_bindHandlers:function(){this._startDrag=this._startDrag.bind(this),this._drag=this._drag.bind(this),this._endDrag=this._endDrag.bind(this),this._doubleClickTitle=this._doubleClickTitle.bind(this),this._onKeyUp=this._onKeyUp.bind(this)},_createPanel:function(e,t){this._panel=document.createElement("div"),this._panel.className="msettings_main",this.setPosition(e||0,t||0),this._controls={}},_createTitleBar:function(e){this._titleBar=document.createElement("div"),this._titleBar.textContent=e,this._titleBar.className="msettings_title_bar",this._titleBar.addEventListener("mousedown",this._startDrag),this._titleBar.addEventListener("dblclick",this._doubleClickTitle),this._panel.appendChild(this._titleBar)},_createContent:function(){this._content=document.createElement("div"),this._content.className="msettings_content",this._panel.appendChild(this._content)},setPosition:function(e,t){this._panel.style.left=e+"px",this._panel.style.top=Math.max(t,0)+"px"},setSize:function(e,t){this._panel.style.width=e+"px",this._content.style.width=e+"px",this._content.style.height=t-this._titleBar.offsetHeight+"px"},setWidth:function(e){this._panel.style.width=e+"px",this._content.style.width=e+"px"},setDraggable:function(e){this._draggable=e,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default"},setCollapsible:function(e){this._collapsible=e,this._draggable||this._collapsible?this._titleBar.style.cursor="pointer":this._titleBar.style.cursor="default"},_startDrag:function(t){this._draggable&&(this._panel.style.zIndex=++e._topZ,document.addEventListener("mousemove",this._drag),document.addEventListener("mouseup",this._endDrag),this._startX=t.clientX,this._startY=t.clientY),t.preventDefault()},_drag:function(e){var t=parseInt(this._panel.style.left),n=parseInt(this._panel.style.top),r=e.clientX,i=e.clientY;this.setPosition(t+r-this._startX,n+i-this._startY),this._startX=r,this._startY=i,e.preventDefault()},_endDrag:function(e){document.removeEventListener("mousemove",this._drag),document.removeEventListener("mouseup",this._endDrag),e.preventDefault()},_doubleClickTitle:function(){this._collapsible&&this.toggleCollapsed()},setGlobalChangeHandler:function(e){this._globalChangeHandler=e},toggleCollapsed:function(){this._collapsed?this.expand():this.collapse()},collapse:function(){this._panel.removeChild(this._content),this._collapsed=!0},expand:function(){this._panel.appendChild(this._content),this._collapsed=!1},hide:function(){this._panel.style.visibility="hidden",this._hidden=!0},show:function(){this._panel.style.visibility="visible",this._hidden=!1},_createContainer:function(){var e=document.createElement("div");return e.className="msettings_container",e},_createLabel:function(e){var t=document.createElement("div");return t.innerHTML=e,t.className="msettings_label",t},setKey:function(e){this._keyCode=e.toUpperCase().charCodeAt(0),document.body.addEventListener("keyup",this.onKeyUp)},_onKeyUp:function(e){e.keyCode===this._keyCode&&this.toggleVisibility()},toggleVisibility:function(){this._hidden?this.show():this.hide()},bindRange:function(e,t,n,r,i,s){this.addRange(e,t,n,r,i,function(t){s[e]=t})},addRange:function(e,t,n,r,i,s){var o=this._createContainer(),u=document.createElement("input");u.type="range",u.id=e,u.min=t||0,u.max=n||100,u.step=i||1,u.value=r||0,u.className="msettings_range";var a=this._createLabel("<b>"+e+":</b> "+u.value);o.appendChild(a),o.appendChild(u),this._content.appendChild(o),this._controls[e]={container:o,control:u,label:a,callback:s};var f="input";this._isIE()&&(f="change");var l=this._globalChangeHandler;u.addEventListener(f,function(){a.innerHTML="<b>"+e+":</b> "+u.value,s&&s(parseFloat(u.value)),l&&l()})},_isIE:function(){return navigator.userAgent.indexOf("rv:11")!=-1?!0:navigator.userAgent.indexOf("MSIE")!=-1?!0:!1},getRangeValue:function(e){return this._controls[e].control.value},setRangeValue:function(e,t){var n=this._controls[e];n.control.value=t,n.label.innerHTML="<b>"+e+":</b> "+n.control.value,n.callback&&n.callback(parseFloat(n.control.value)),this._globalChangeHandler&&this._globalChangeHandler()},setRangeParameters:function(e,t,n,r){var i=this._controls[e];i.control.min=t,i.control.max=n,i.control.step=r},bindBoolean:function(e,t,n){this.addBoolean(e,t,function(t){n[e]=t})},addBoolean:function(e,t,n){var r=this._createContainer(),i=document.createElement("span");i.className="msettings_checkbox_label",i.textContent=e;var s=document.createElement("input");s.type="checkbox",s.id=e,s.checked=t,s.className="msettings_checkbox",r.appendChild(s),r.appendChild(i),this._content.appendChild(r),this._controls[e]={container:r,control:s,callback:n};var o=this._globalChangeHandler;s.addEventListener("change",function(){n&&n(s.checked),o&&o()}),i.addEventListener("click",function(){if(s.disabled)return;s.checked=!s.checked,n&&n(s.checked),o&&o()})},getBoolean:function(e){return this._controls[e].control.checked},setBoolean:function(e,t){this._controls[e].control.checked=t,this._controls[e].callback&&this._controls[e].callback(t),this._globalChangeHandler&&this._globalChangeHandler()},addButton:function(e,t){var n=this._createContainer(),r=document.createElement("input");r.type="button",r.id=e,r.value=e,r.className="msettings_button",n.appendChild(r),this._content.appendChild(n),this._controls[e]={container:n,control:r};var i=this._globalChangeHandler;r.addEventListener("click",function(){t&&t(r),i&&i()})},bindColor:function(e,t,n){this.addColor(e,t,function(t){n[e]=t})},addColor:function(e,t,n){var r=this._createContainer(),i=this._createLabel("<b>"+e+":</b> "+t),s=document.createElement("input");try{s.type="color"}catch(o){s.type="text"}s.id=e,s.value=t||"#ff0000",s.className="msettings_color",r.appendChild(i),r.appendChild(s),this._content.appendChild(r),this._controls[e]={container:r,control:s,label:i,callback:n};var u=this._globalChangeHandler;s.addEventListener("input",function(){i.innerHTML="<b>"+e+":</b> "+s.value,n&&n(s.value),u&&u()})},getColor:function(e){return this._controls[e].control.value},setColor:function(e,t){var n=this._controls[e];n.control.value=t,n.label.innerHTML="<b>"+e+":</b> "+n.control.value,n.callback&&n.callback(n.control.value),this._globalChangeHandler&&this._globalChangeHandler()},bindText:function(e,t,n){this.addText(e,t,function(t){n[e]=t})},addText:function(e,t,n){var r=this._createContainer(),i=this._createLabel("<b>"+e+"</b>"),s=document.createElement("input");s.type="text",s.id=e,s.value=t||"",s.className="msettings_text_input",r.appendChild(i),r.appendChild(s),this._content.appendChild(r),this._controls[e]={container:r,control:s,label:i,callback:n};var o=this._globalChangeHandler;s.addEventListener("input",function(){n&&n(s.value),o&&o()})},addTextArea:function(e,t,n){var r=this._createContainer(),i=this._createLabel("<b>"+e+"</b>"),s=document.createElement("textarea");s.id=e,s.rows=5,s.value=t||"",s.className="msettings_textarea",r.appendChild(i),r.appendChild(s),this._content.appendChild(r),this._controls[e]={container:r,control:s,label:i,callback:n};var o=this._globalChangeHandler;s.addEventListener("input",function(){n&&n(s.value),o&&o()})},setTextAreaRows:function(e,t){this._controls[e].control.rows=t},getText:function(e){return this._controls[e].control.value},setText:function(e,t){var n=this._controls[e];n.control.value=t,n.callback&&n.callback(t),this._globalChangeHandler&&this._globalChangeHandler()},addInfo:function(e,t){var n=this._createContainer();n.innerHTML=t,this._controls[e]={container:n},this._content.appendChild(n)},bindDropDown:function(e,t,n){this.addDropDown(e,t,function(t){n[e]=t.value})},addDropDown:function(e,t,n){var r=this._createContainer(),i=this._createLabel("<b>"+e+"</b>"),s=document.createElement("select");for(var o=0;o<t.length;o++){var u=document.createElement("option");u.label=t[o],s.add(u)}var a=this._globalChangeHandler;s.addEventListener("change",function(){var e=s.selectedIndex,t=s.options;n&&n({index:e,value:t[e].label}),a&&a()}),s.className="msettings_select",r.appendChild(i),r.appendChild(s),this._content.appendChild(r),this._controls[e]={container:r,control:s,label:i,callback:n}},getDropDownValue:function(e){var t=this._controls[e],n=t.control,r=n.selectedIndex,i=n.options;return{index:r,value:i[r].label}},setDropDownIndex:function(e,t){var n=this._controls[e],r=n.control.options;n.control.selectedIndex=t,n.callback&&n.callback({index:t,value:r[t].label}),this._globalChangeHandler&&this._globalChangeHandler()},getInfo:function(e){return this._controls[e].container.innerHTML},setInfo:function(e,t){this._controls[e].container.innerHTML=t},addImage:function(e,t){var n=this._createContainer(),r=this._createLabel("<b>"+e+"</b>");img=document.createElement("img"),img.className="msettings_image",img.src=t,n.appendChild(r),n.appendChild(img),this._content.appendChild(n),this._controls[e]={container:n,control:img,label:r}},setImageURL:function(e,t){this._controls[e].control.src=t},addProgressBar:function(e,t,n,r){var i=this._createContainer(),s=this._createLabel("");progress=document.createElement("progress"),progress.className="msettings_progress",progress.max=t,progress.value=n,r?s.innerHTML="<b>"+e+":<b> "+n+" / "+t:s.innerHTML="<b>"+e+"<b>",i.appendChild(s),i.appendChild(progress),this._content.appendChild(i),this._controls[e]={container:i,control:progress,showNumbers:r,label:s}},getProgress:function(e){return this._controls[e].control.value},setProgress:function(e,t){var n=this._controls[e].control;n.value=t,this._controls[e].showNumbers?this._controls[e].label.innerHTML="<b>"+e+":<b> "+n.value+" / "+n.max:this._controls[e].label.innerHTML="<b>"+e+"<b>"},addElement:function(e,t){var n=this._createContainer(),r=this._createLabel("<b>"+e+"</b>");n.appendChild(r),n.appendChild(t),this._content.appendChild(n),this._controls[e]={container:n,label:r}},addHTML:function(e,t){var n=document.createElement("div");n.innerHTML=t,this.addElement(e,n)},removeControl:function(e){if(this._controls[e])var t=this._controls[e].container;t&&t.parentElement&&t.parentElement.removeChild(t),this._controls[e]=null},enableControl:function(e){this._controls[e].control&&(this._controls[e].control.disabled=!1)},disableControl:function(e){this._controls[e].control&&(this._controls[e].control.disabled=!0)}};typeof define=="function"&&define.amd?define("libs/quicksettings",e):window.QuickSettings=e}(),define("libs/LZWEncoder",[],function(){function i(i,s,o,u){function E(e,t){f[d++]=e,d>=254&&C(t)}function S(e){x(n),v=b+2,g=!0,A(b,e)}function x(e){for(var t=0;t<e;++t)l[t]=-1}function T(r,i){var s,o,u,a,f,h,p;y=r,g=!1,n_bits=y,m=k(n_bits),b=1<<r-1,w=b+1,v=b+2,d=0,a=L(),p=0;for(s=n;s<65536;s*=2)++p;p=8-p,h=n,x(h),A(b,i);e:while((o=L())!=e){s=(o<<t)+a,u=o<<p^a;if(l[u]===s){a=c[u];continue}if(l[u]>=0){f=h-u,u===0&&(f=1);do{(u-=f)<0&&(u+=h);if(l[u]===s){a=c[u];continue e}}while(l[u]>=0)}A(a,i),a=o,v<1<<t?(c[u]=v++,l[u]=s):S(i)}A(a,i),A(w,i)}function N(e){e.writeByte(a),remaining=i*s,curPixel=0,T(a+1,e),e.writeByte(0)}function C(e){d>0&&(e.writeByte(d),e.writeBytes(f,0,d),d=0)}function k(e){return(1<<e)-1}function L(){if(remaining===0)return e;--remaining;var t=o[curPixel++];return t&255}function A(e,n){h&=r[p],p>0?h|=e<<p:h=e,p+=n_bits;while(p>=8)E(h&255,n),h>>=8,p-=8;if(v>m||g)g?(m=k(n_bits=y),g=!1):(++n_bits,n_bits==t?m=1<<t:m=k(n_bits));if(e==w){while(p>0)E(h&255,n),h>>=8,p-=8;C(n)}}var a=Math.max(2,u),f=new Uint8Array(256),l=new Int32Array(n),c=new Int32Array(n),h,p=0,d,v=0,m,g=!1,y,b,w;this.encode=N}var e=-1,t=12,n=5003,r=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];return i}),define("libs/NeuQuant",[],function(){function B(t,n,r){var i,s;L=t,A=n,O=r,M=new Array(e);for(i=0;i<e;i++)M[i]=new Array(4),s=M[i],s[0]=s[1]=s[2]=(i<<u+8)/e,P[i]=l/e,D[i]=0;this.process=F,this.map=U,this.setMaxColors=j}function j(t){e=t,o=e-1,m=e>>3,b=m*y}function F(){return R(),z(),q(),I()}function I(){var t=[],n=new Array(e);for(var r=0;r<e;r++)n[M[r][3]]=r;var i=0;for(var s=0;s<e;s++){var o=n[s];t[i++]=M[o][0],t[i++]=M[o][1],t[i++]=M[o][2]}return t}function q(){var t,n,r,i,s,u,a,f;a=0,f=0;for(t=0;t<e;t++){s=M[t],r=t,i=s[1];for(n=t+1;n<e;n++)u=M[n],u[1]<i&&(r=n,i=u[1]);u=M[r],t!=r&&(n=u[0],u[0]=s[0],s[0]=n,n=u[1],u[1]=s[1],s[1]=n,n=u[2],u[2]=s[2],s[2]=n,n=u[3],u[3]=s[3],s[3]=n);if(i!=a){_[a]=f+t>>1;for(n=a+1;n<i;n++)_[n]=t;a=i,f=t}}_[a]=f+o>>1;for(n=a+1;n<256;n++)_[n]=o}function R(){var e,o,f,l,c,h,p,d,v,m,y,E,T,C;A<s&&(O=1),x=30+(O-1)/3,E=L,T=0,C=A,y=A/(3*O),m=y/a|0,d=S,h=b,p=h>>g,p<=1&&(p=0);for(e=0;e<p;e++)H[e]=d*((p*p-e*e)*N/(p*p));A<s?v=3:A%t!==0?v=3*t:A%n!==0?v=3*n:A%r!==0?v=3*r:v=3*i,e=0;while(e<y){f=(E[T+0]&255)<<u,l=(E[T+1]&255)<<u,c=(E[T+2]&255)<<u,o=V(f,l,c),X(d,o,f,l,c),p!==0&&W(p,o,f,l,c),T+=v,T>=C&&(T-=A),e++,m===0&&(m=1);if(e%m===0){d-=d/x,h-=h/w,p=h>>g,p<=1&&(p=0);for(o=0;o<p;o++)H[o]=d*((p*p-o*o)*N/(p*p))}}}function U(t,n,r){var i,s,o,u,a,f,l;a=1e3,l=-1,i=_[n],s=i-1;while(i<e||s>=0)i<e&&(f=M[i],o=f[1]-n,o>=a?i=e:(i++,o<0&&(o=-o),u=f[0]-t,u<0&&(u=-u),o+=u,o<a&&(u=f[2]-r,u<0&&(u=-u),o+=u,o<a&&(a=o,l=f[3])))),s>=0&&(f=M[s],o=n-f[1],o>=a?s=-1:(s--,o<0&&(o=-o),u=f[0]-t,u<0&&(u=-u),o+=u,o<a&&(u=f[2]-r,u<0&&(u=-u),o+=u,o<a&&(a=o,l=f[3]))));return l}function z(){var t,n;for(t=0;t<e;t++)M[t][0]>>=u,M[t][1]>>=u,M[t][2]>>=u,M[t][3]=t}function W(t,n,r,i,s){var o,u,a,f,l,c,h;a=n-t,a<-1&&(a=-1),f=n+t,f>e&&(f=e),o=n+1,u=n-1,c=1;while(o<f||u>a){l=H[c++];if(o<f){h=M[o++];try{h[0]-=l*(h[0]-r)/k,h[1]-=l*(h[1]-i)/k,h[2]-=l*(h[2]-s)/k}catch(p){}}if(u>a){h=M[u--];try{h[0]-=l*(h[0]-r)/k,h[1]-=l*(h[1]-i)/k,h[2]-=l*(h[2]-s)/k}catch(p){}}}}function X(e,t,n,r,i){var s=M[t];s[0]-=e*(s[0]-n)/S,s[1]-=e*(s[1]-r)/S,s[2]-=e*(s[2]-i)/S}var e=256,t=499,n=491,r=487,i=503,s=3*i,o=e-1,u=4,a=100,f=16,l=1<<f,c=10,h=1<<c,p=10,d=l>>p,v=l<<c-p,m=e>>3,g=6,y=1<<g,b=m*y,w=30,E=10,S=1<<E,x,T=8,N=1<<T,C=E+T,k=1<<C,L,A,O,M,_=[],D=[],P=[],H=[],V=function(n,r,i){var s,o,a,l,h,m,g,y,b,w;y=2147483647,b=y,m=-1,g=m;for(s=0;s<e;s++)w=M[s],o=w[0]-n,o<0&&(o=-o),a=w[1]-r,a<0&&(a=-a),o+=a,a=w[2]-i,a<0&&(a=-a),o+=a,o<y&&(y=o,m=s),l=o-(D[s]>>f-u),l<b&&(b=l,g=s),h=P[s]>>p,P[s]-=h,D[s]+=h<<c;return P[m]+=d,D[m]-=v,g};return B}),define("libs/GIFEncoder",["libs/LZWEncoder","libs/NeuQuant"],function(e,t){function i(){this.bin=[]}for(var n=0,r={};n<256;n++)r[n]=String.fromCharCode(n);i.prototype.getData=function(){for(var e="",t=this.bin.length,n=0;n<t;n++)e+=r[this.bin[n]];return e},i.prototype.writeByte=function(e){this.bin.push(e)},i.prototype.writeUTFBytes=function(e){for(var t=e.length,n=0;n<t;n++)this.writeByte(e.charCodeAt(n))},i.prototype.writeBytes=function(e,t,n){for(var r=n||e.length,i=t||0;i<r;i++)this.writeByte(e[i])};var s={},o,u,a=null,f,l=-1,c=0,h=!1,p,d,v,m,g,y,b=[],w=7,E=-1,S=!1,x=!0,T=!1,N=10,C="Generated by jsgif (https://github.com/antimatter15/jsgif/)",k=256,L=s.setDelay=function(t){c=Math.round(t/10)},A=s.setDispose=function(t){t>=0&&(E=t)},O=s.setRepeat=function(t){t>=0&&(l=t)},M=s.setTransparent=function(t){a=t},_=s.setComment=function(t){C=t},D=s.addFrame=function(t,n){if(t===null||!h||p===null)throw new Error("Please call start method before calling addFrame");var r=!0;try{n?d=t:(d=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,T||F(t.canvas.width,t.canvas.height)),W(),U(),x&&(J(),Q(),l>=0&&K()),X(),C!==""&&V(),$(),x||Q(),Y(),x=!1}catch(i){r=!1}return r},P=s.finish=function(){if(!h)return!1;var t=!0;h=!1;try{p.writeByte(59)}catch(n){t=!1}return t},H=function(){f=0,d=null,v=null,m=null,y=null,S=!1,x=!0},B=s.setFrameRate=function(t){t!=15&&(c=Math.round(100/t))},j=s.setQuality=function(t){t<1&&(t=1),N=t},F=s.setSize=function(t,n){if(h&&!x)return;o=t,u=n,o<1&&(o=320),u<1&&(u=240),T=!0},I=s.start=function(){H();var t=!0;S=!1,p=new i;try{p.writeUTFBytes("GIF89a")}catch(n){t=!1}return h=t},q=s.cont=function(){H();var t=!0;return S=!1,p=new i,h=t},R=s.setMaxColors=function(t){k=t},U=function(){var n=v.length,r=n/3;m=[];var i=new t(v,n,N);i.setMaxColors(k),y=i.process();var s=0;for(var o=0;o<r;o++){var u=i.map(v[s++]&255,v[s++]&255,v[s++]&255);b[u]=!0,m[o]=u}v=null,g=8,w=7,a!==null&&(f=z(a))},z=function(t){if(y===null)return-1;var n=(t&16711680)>>16,r=(t&65280)>>8,i=t&255,s=0,o=16777216,u=y.length;for(var a=0;a<u;){var f=n-(y[a++]&255),l=r-(y[a++]&255),c=i-(y[a]&255),h=f*f+l*l+c*c,p=a/3;b[p]&&h<o&&(o=h,s=p),a++}return s},W=function(){var t=o,n=u;v=[];var r=d,i=0;for(var s=0;s<n;s++)for(var a=0;a<t;a++){var f=s*t*4+a*4;v[i++]=r[f],v[i++]=r[f+1],v[i++]=r[f+2]}},X=function(){p.writeByte(33),p.writeByte(249),p.writeByte(4);var t,n;a===null?(t=0,n=0):(t=1,n=2),E>=0&&(n=E&7),n<<=2,p.writeByte(0|n|0|t),G(c),p.writeByte(f),p.writeByte(0)},V=function(){p.writeByte(33),p.writeByte(254),p.writeByte(C.length),p.writeUTFBytes(C),p.writeByte(0)},$=function(){p.writeByte(44),G(0),G(0),G(o),G(u),x?p.writeByte(0):p.writeByte(128|w)},J=function(){G(o),G(u),p.writeByte(240|w),p.writeByte(0),p.writeByte(0)},K=function(){p.writeByte(33),p.writeByte(255),p.writeByte(11),p.writeUTFBytes("NETSCAPE2.0"),p.writeByte(3),p.writeByte(1),G(l),p.writeByte(0)},Q=function(){p.writeBytes(y);var t=768-y.length;for(var n=0;n<t;n++)p.writeByte(0)},G=function(t){p.writeByte(t&255),p.writeByte(t>>8&255)},Y=function(){var n=new e(o,u,m,g);n.encode(p)},Z=s.stream=function(){return p},et=s.setProperties=function(t,n){h=t,x=n};return s}),define("libs/color",[],function(){function e(e,t,n,r){var i=Object.create(p);return i.setRGBA(e,t,n,r),i.toString()}function t(t,n,r){return e(t,n,r,1)}function n(e,n){return e=e||0,n=n||256,t(Math.floor(e+Math.random()*(n-e)),Math.floor(e+Math.random()*(n-e)),Math.floor(e+Math.random()*(n-e)))}function r(e,t){return e=e||0,t=t||256,i(Math.floor(e+Math.random()*(t-e)))}function i(e){return t(e,e,e)}function s(e){var n=e>>16,r=e>>8&255,i=e&255;return t(n,r,i)}function o(e,t,n,r,i,s){var o=e+Math.random()*(t-e),u=n+Math.random()*(r-n),f=i+Math.random()*(s-i);return a(o,u,f)}function u(t,n,r,i){var s,o,u,a=Math.floor(t/60),f=t/60-a,l=r*(1-n),c=r*(1-f*n),h=r*(1-(1-f)*n);switch(a%6){case 0:s=r,o=h,u=l;break;case 1:s=c,o=r,u=l;break;case 2:s=l,o=r,u=h;break;case 3:s=l,o=c,u=r;break;case 4:s=h,o=l,u=r;break;case 5:s=r,o=l,u=c}return e(Math.floor(s*255),Math.floor(o*255),Math.floor(u*255),i)}function a(e,t,n){return u(e,t,n,1)}function f(e,t,n,r,i,s,o,a){return function(f){var l=e+f*(t-e),c=n+f*(r-n),h=i+f*(s-i),p=o+f*(a-o);return u(l,c,h,p)}}function l(e,t,n,r,i,s){return f(e,t,n,r,i,s,1,1)}function c(e,t,n,r){var i={type:"linearGradient",x0:e,y0:t,x1:n,y1:r,colorStops:[],addColorStop:function(e,t){this.colorStops.push({position:e,color:t})}};return i}function h(e,t,n,r,i,s){var o={type:"radialGradient",x0:e,y0:t,r0:n,x1:r,y1:i,r1:s,colorStops:[],addColorStop:function(e,t){this.colorStops.push({position:e,color:t})}};return o}var p={r:255,g:255,b:255,a:1,setRGBA:function(e,t,n,r){return this.r=e,this.g=t,this.b=n,this.a=r,this},toString:function(){return"rgba("+Math.floor(this.r)+","+Math.floor(this.g)+","+Math.floor(this.b)+","+this.a+")"}};return{rgb:t,rgba:e,randomRGB:n,randomGray:r,gray:i,num:s,hsv:a,hsva:u,animHSV:l,animHSVA:f,randomHSV:o,createLinearGradient:c,createRadialGradient:h}}),define("app/ui/controlpanel",["libs/quicksettings"],function(e){function S(S,A){n=S,r=A,t=e.create(n.w+50,20,"Control Panel");if(window.nodeRequire){var O=nodeRequire("remote");O&&t.addButton(E,function(){var e=O.getCurrentWindow();e.isFullScreen()?e.setFullScreen(!1):e.setFullScreen(!0)})}i=document.createElement("input"),i.type="file",i.addEventListener("change",r.chooseFile),t.addButton(s,function(){i.click()}),t.addInfo(u,""),t.addButton(o,r.reload),t.disableControl(o),t.addRange(f,.5,10,n.getDuration(),.5,n.setDuration),t.addRange(l,1,60,n.getFPS(),1,n.setFPS),t.addRange(c,2,256,n.maxColors,1,function(e){n.maxColors=e}),t.bindDropDown(a,["bounce","single"],n.interpolation),t.bindBoolean(h,n.interpolation.easing,n.interpolation),t.addButton(p,x),t.addButton(d,T),t.addButton(v,L),t.addButton(m,N),t.addButton(g,C),t.addButton(y,k),t.addInfo(b,"stopped"),t.addButton(w,function(){r.showInfoPanel()})}function x(){t.setInfo(b,"playing"),r.playOnce(),r.disableControls()}function T(){t.setInfo(b,"playing"),r.loop(),r.disableControls()}function N(){n.getIsRunning()?t.setInfo(b,"Animation already running"):(r.clearOutput(),n.capture=!0,r.startEncoder(),x())}function C(){n.getIsRunning()?t.setInfo(b,"Animation already running"):(r.clearOutput(),n.captureSpriteSheet=!0,r.initSpriteSheet(),x())}function k(){r.captureStill()}function L(){O("stopped"),r.stop(),r.enableControls()}function A(e,n){t.setPosition(e,n)}function O(e){t.setInfo(b,e)}function M(){t.enableControl(p),t.enableControl(d),t.enableControl(m),t.enableControl(g)}function _(){t.disableControl(p),t.disableControl(d),t.disableControl(m),t.disableControl(g)}function D(e){t.setRangeValue(l,e)}function P(e){t.setRangeValue(f,e)}function H(e){t.setDropDownIndex(a,e==="bounce"?0:1)}function B(e){t.setBoolean(h,e)}function j(e){e=Math.max(2,e),e=Math.min(256,e),t.setRangeValue(c,e)}function F(e){t.setInfo(u,e),t.enableControl(o)}function I(){i.click()}var t=null,n,r,i=null,s="Open File",o="Reload",u="File name",a="mode",f="duration",l="fps",c="Max Colors",h="easing",p="Play Once",d="Loop",v="Stop",m="Make a gif",g="Make a sprite sheet",y="Capture still",b="status",w="about",E="Full Screen";return{init:S,setPosition:A,setStatus:O,enableControls:M,disableControls:_,loop:T,playOnce:x,setFPS:D,setDuration:P,setMode:H,setEasing:B,setMaxColors:j,setFileName:F,makeGif:N,chooseFileDialog:I}}),define("app/ui/infopanel",["libs/quicksettings"],function(e){function n(t,n){infoPanel=e.create(100,100,"GIF Loop Coder"),infoPanel.addInfo("Info","Howdy! Welcome to GIF Loop Coder (GLC). This program is offered free and is open source. Lots of hours went into it, so if you find it useful, pay it back or pay it forward."),infoPanel.addInfo("tips","<a href='https://www.paypal.me/bit101'>Buy me a beer (or two)</a>"),infoPanel.addInfo("keys","Keys:<br/>P - play/pause<br/>F - choose file<br/>R - reload file<br/>G - make gif<br/>S - capture still"),infoPanel.addInfo("credits","Credits:"),infoPanel.addInfo("creator","Architect, coding, design, etc.: Keith Peters, kp@bit-101.com"),infoPanel.addInfo("testers","Contributors: <a href='https://twitter.com/p5art'>Jerome Herr</a>, <a href='https://twitter.com/cacheflowe'>Justin Gitlin</a>, <a href='https://twitter.com/andremichelle'>Andre Michelle</a>, <a href='https://twitter.com/msurguy'>Maks Surguy</a>, <a href='https://github.com/EduardoLopes'>Eduardo Lopes</a>, <a href='https://github.com/crummy'>Malcolm Crum</a>, <a href='https://github.com/Landerson352'>Lincoln Anderson</a>"),infoPanel.addInfo("encoder","GIF Encoder: Kevin Weiner, Thibault Imbert, Kevin Kwok, Johan Nordberg"),infoPanel.addInfo("QS","User interface created with <a href='https://github.com/bit101/quicksettings'>QuickSettings.js</a>."),infoPanel.addButton("Close",function(){infoPanel.hide()}),infoPanel.hide()}function r(){infoPanel.show()}function i(e,t){infoPanel.setPosition(e,t)}var t=null;return{init:n,setPosition:i,show:r}}),define("app/ui/canvaspanel",["libs/quicksettings"],function(e){function i(i,o,u){n=i,r=o,t=e.create(20,20,"Canvas Panel"),t.setWidth(n.w+12),t.addElement("Canvas",u),t.addRange("Scrub",0,1,0,.01,s)}function s(e){n.getIsRunning()||r.renderFrame(e)}function o(e){t.setWidth(e)}function u(e){t.setRangeValue("Scrub",e)}function a(){t.disableControl("Scrub")}function f(){t.enableControl("Scrub")}var t=null,n=null,r=null;return{init:i,setWidth:o,setTime:u,disableControls:a,enableControls:f}}),define("app/ui/outputpanel",["libs/quicksettings"],function(e){function a(a,f){n=a,r=f,t=e.create(n.w+220,20,"Output"),t.setWidth(n.w+12),t.addImage(i,""),t.addInfo(s,""),t.addButton(o,r.clearOutput),t.addButton(u,function(){p(),t.hide()})}function f(e){t.show();var n="data:image/gif;base64,"+d(e);t.setImageURL(i,n);var r="data:image/gif;base64,",o=Math.round((n.length-r.length)*3/4);t.setInfo(s,"Approx size: "+Math.round(o/1024)+"kb")}function l(e){t.show(),t.setImageURL(i,e);var n="data:image/png;base64,",r=Math.round((e.length-n.length)*3/4);t.setInfo(s,"Approx size: "+Math.round(r/1024)+"kb")}function c(e){t.setWidth(e)}function h(e,n){t.setPosition(e,n)}function p(){t.setImageURL(i,""),t.setInfo(s,""),t.setWidth(n.w+12)}function d(e){var t="",n=0,r=e.length,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s,o,u,a,f,l,c;while(n<r)s=e.charCodeAt(n++),o=e.charCodeAt(n++),u=e.charCodeAt(n++),a=s>>2,f=(s&3)<<4|o>>4,l=(o&15)<<2|u>>6,c=u&63,isNaN(o)?l=c=64:isNaN(u)&&(c=64),t=t+i.charAt(a)+i.charAt(f)+i.charAt(l)+i.charAt(c);return t}var t=null,n=null,r=null,i="Capture",s="size",o="Clear Image",u="Close";return{init:a,setGIF:f,setPNG:l,setWidth:c,setPosition:h,clearOutput:p}}),define("app/glc",["app/renderlist","app/scheduler","app/styles","app/interpolation","app/spritesheet","libs/quicksettings","libs/GIFEncoder","libs/color","app/ui/controlpanel","app/ui/infopanel","app/ui/canvaspanel","app/ui/outputpanel"],function(e,t,n,r,i,s,o,u,a,f,l,c){function d(){e.init(h.w,h.h,n,r),t.init(y,b),l.init(h,p,e.getCanvas()),c.init(h,p),f.init(h,p),a.init(h,p),g(),m()}function v(t,n){this.w=h.w=t,this.h=h.h=n,o.setSize(t,n),i.setSize(t,n),e.size(h.w,h.h),l.setWidth(h.w+12),c.setWidth(h.w+12),a.setPosition(h.w+50,20),c.setPosition(h.w+220,20)}function m(){document.body.addEventListener("keyup",function(e){console.log(e.keyCode);switch(e.keyCode){case 82:N();break;case 80:t.isRunning()?p.stop():p.loop();break;case 71:a.makeGif();break;case 83:p.captureStill();break;case 70:a.chooseFileDialog();break;default:}})}function g(){t.renderCallback=y,t.completeCallback=b}function y(t){l.setTime(t),e.render(t),h.capture&&(a.setStatus("capturing..."),o.addFrame(e.getContext())),h.captureSpriteSheet&&i.addFrame(e.getCanvas())}function b(){h.capture&&(h.capture=!1,o.finish(),c.setGIF(o.stream().getData())),h.captureSpriteSheet&&(h.captureSpriteSheet=!1,c.setWidth(i.getSpriteSheetSize()+12),c.setPNG(i.getImage())),a.setStatus("stopped"),p.enableControls()}function w(){a.enableControls(),l.enableControls()}function E(){a.disableControls(),l.disableControls()}function S(){var t=e.getCanvas(),n=t.toDataURL();c.setWidth(h.w+12),c.setPNG(n)}function x(){o.setMaxColors(h.maxColors),o.setRepeat(0),o.setDelay(1e3/t.getFPS()),o.start()}function T(e){h.file=e.target.files[0],a.setFileName(h.file.name),N()}function N(){if(!h.file)return;p.clearOutput();var t=new FileReader;t.onload=function(){e.clear(),k();var n=document.getElementById("loaded_script");n&&document.head.removeChild(n),n=document.createElement("script"),n.id="loaded_script",document.head.appendChild(n),n.textContent=t.result,window.onGLC&&window.onGLC(A)},t.readAsText(h.file)}function C(){f.show()}function k(){A.size(400,400),A.setFPS(30),A.setDuration(2),A.setMode("bounce"),A.setEasing(!0),A.setMaxColors(256),A.setQuality(10),A.styles.backgroundColor="#ffffff",A.styles.lineWidth=5,A.styles.strokeStyle="#000000",A.styles.fillStyle="#000000",A.styles.lineCap="round",A.styles.lineJoin="miter",A.styles.lineDash=[],A.styles.miterLimit=10,A.styles.shadowColor=null,A.styles.shadowOffsetX=null,A.styles.shadowOffsetY=null,A.styles.shadowBlur=null,A.styles.globalAlpha=1,A.styles.translationX=0,A.styles.translationY=0,A.styles.shake=0,A.styles.blendMode="source-over"}function L(){i.init(t.getFPS(),t.getDuration())}var h={interpolation:r,file:null,maxColors:256,w:400,h:400,capture:!1,captureSpriteSheet:!1,getDuration:function(){return t.getDuration()},setDuration:function(e){t.setDuration(e)},getFPS:function(){return t.getFPS()},setFPS:function(e){t.setFPS(e)},getIsRunning:function(){return t.isRunning()}},p={playOnce:t.playOnce,loop:t.loop,stop:t.stop,enableControls:w,disableControls:E,clearOutput:c.clearOutput,captureStill:S,renderFrame:e.render,startEncoder:x,chooseFile:T,reload:N,showInfoPanel:C,initSpriteSheet:L},A={w:h.w,h:h.h,renderList:e,styles:n,size:v,playOnce:a.playOnce,loop:a.loop,setFPS:a.setFPS,setDuration:a.setDuration,setMode:a.setMode,setEasing:a.setEasing,setMaxColors:a.setMaxColors,setQuality:o.setQuality,color:u};return d(),A}),require(["app/glc"],function(e){window.onGLC?window.onGLC(e):window.glc=e}),define("glcloader",function(){});